# TikTok Shop 榜单数据采集教程

## 📋 目录
1. [准备工作](#准备工作)
2. [八爪鱼RPA采集方案](#八爪鱼rpa采集方案)
3. [详细操作步骤](#详细操作步骤)
4. [常见问题解决](#常见问题解决)
5. [数据导出与分析](#数据导出与分析)

---

## 准备工作

### 1.1 工具准备
- ✅ 八爪鱼RPA客户端（已安装）
- ✅ TikTok Shop商家账号
- ✅ Chrome浏览器（推荐）
- ✅ 稳定的网络环境

### 1.2 数据需求确认
首先明确你要采集哪些榜单数据：
- 📊 **热销商品榜**：销量排名、商品名称、价格
- 💰 **销售额榜**：GMV排名、店铺名称
- 🏪 **店铺排行榜**：店铺评分、粉丝数
- 📈 **增长榜单**：增长率、新增订单

### 1.3 登录状态
```
⚠️ 重要提示：
1. 提前登录TikTok Shop后台
2. 保持登录状态（建议保存密码）
3. 准备好验证码接收（如果有二次验证）
```

---

## 八爪鱼RPA采集方案

### 2.1 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **方案一：八爪鱼RPA** | 无代码、可视化操作 | 可能遇到反爬虫 | 小数据量、日常采集 |
| **方案二：Python爬虫** | 灵活强大 | 需要编程基础 | 大数据量、复杂逻辑 |
| **方案三：API接口** | 稳定高效 | 需要申请权限 | 商业化应用 |

### 2.2 推荐方案：八爪鱼RPA
**为什么选择八爪鱼？**
- ✅ 无需编程，拖拽即可
- ✅ 云端/本地两种运行模式
- ✅ 支持定时任务
- ✅ 自动处理翻页
- ✅ 数据格式丰富导出

---

## 详细操作步骤

### 步骤1：创建新任务

#### 1.1 打开八爪鱼
```bash
1. 启动八爪鱼RPA客户端
2. 点击"新建" → "自定义任务"
3. 输入任务名称：TikTok_Shop_榜单采集
4. 选择"本地采集"模式
```

#### 1.2 设置起始页面
```
URL示例：
- https://seller.tiktokglobalshop.com/
- https://seller.tiktokglobalshop.com/analytics/dashboard
```

### 步骤2：登录操作录制

#### 2.1 录制登录流程
```
1. 点击"开始录制"
2. 在浏览器中打开TikTok Shop
3. 手动完成登录：
   - 输入邮箱/手机号
   - 输入密码
   - 处理验证码（如需要）
4. 登录成功后停止录制
```

#### 2.2 保存登录状态
```python
# 设置Cookie保存
操作步骤：
1. 点击"高级选项"
2. 勾选"保存Cookie"
3. 设置Cookie有效期：7天
```

### 步骤3：导航到榜单页面

#### 3.1 点击榜单菜单
```
操作流程：
1. 等待页面加载完成（延迟3-5秒）
2. 点击"数据分析"菜单
3. 点击"商品榜单"或"店铺榜单"
4. 选择榜单类型：热销榜/销量榜/增长榜
```

#### 3.2 设置筛选条件（可选）
```
可筛选维度：
- 时间范围：今日/近7天/近30天
- 类目：全类目/特定类目
- 地区：全地区/指定国家
```

### 步骤4：配置数据提取

#### 4.1 识别数据字段
```javascript
// 常见榜单数据字段
{
  "排名": "ranking",
  "商品名称": "product_name",
  "商品ID": "product_id",
  "价格": "price",
  "销量": "sales_count",
  "销售额": "gmv",
  "店铺名称": "shop_name",
  "类目": "category",
  "更新时间": "update_time"
}
```

#### 4.2 使用八爪鱼提取数据
```
操作步骤：
1. 点击"提取数据"工具
2. 点击页面上的数据元素：
   - 排名数字 → 提取为"排名"
   - 商品名称 → 提取为"商品名称"
   - 价格数字 → 提取为"价格"
3. 八爪鱼会自动识别相似元素
4. 点击"提取全部"按钮
```

#### 4.3 配置列表循环
```
设置循环：
1. 选中榜单列表区域
2. 右键 → "提取所有相似数据"
3. 八爪鱼自动创建循环列表
4. 预览提取结果
```

### 步骤5：处理翻页

#### 5.1 自动翻页设置
```
操作配置：
1. 找到"下一页"按钮
2. 点击"循环点击"工具
3. 设置循环条件：
   - 循环次数：10页（或自定义）
   - 判断条件：下一页按钮存在
4. 每页延迟：2-3秒（避免被封）
```

#### 5.2 翻页等待时间
```python
# 推荐配置
延迟设置：
- 页面加载等待：3秒
- 数据提取等待：2秒
- 翻页点击等待：2秒
- 随机延迟：0.5-1.5秒（模拟真人操作）
```

### 步骤6：数据导出

#### 6.1 选择导出格式
```
导出选项：
1. Excel格式（.xlsx） - 推荐
   - 优点：方便查看和编辑
   - 适合：数据量<10万条

2. CSV格式（.csv）
   - 优点：通用性强
   - 适合：数据导入其他系统

3. 数据库
   - 优点：支持大数据量
   - 适合：长期存储和查询
```

#### 6.2 配置导出字段
```
字段选择：
✅ 排名
✅ 商品名称
✅ 价格
✅ 销量
✅ 销售额
✅ 店铺名称
✅ 类目
✅ 采集时间
```

---

## 常见问题解决

### 3.1 反爬虫问题

#### 问题1：频繁要求登录
```
解决方案：
1. 保存Cookie状态
2. 设置采集间隔（建议5-10分钟）
3. 使用代理IP池
4. 模拟真人操作（随机延迟）

八爪鱼配置：
- 点击"防屏蔽"设置
- 开启"智能延迟"
- 设置"User-Agent轮换"
```

#### 问题2：数据加载不出来
```
原因分析：
- AJAX动态加载
- 页面渲染延迟
- 网络波动

解决方案：
1. 增加页面等待时间
2. 使用"滚动加载"功能
3. 添加"等待元素出现"步骤
4. 设置重试机制
```

### 3.2 数据提取问题

#### 问题3：只能提取第一页
```
解决步骤：
1. 检查循环设置
2. 确认"下一页"按钮定位
3. 调整翻页等待时间
4. 查看运行日志

八爪鱼操作：
- 双击"循环点击"步骤
- 检查循环条件
- 设置最大循环次数
```

#### 问题4：数据重复或缺失
```
可能原因：
- 选择器不准确
- 页面结构变化
- 网络中断

解决方案：
1. 重新校准选择器
2. 添加数据去重
3. 设置断点续传
4. 启用错误重试
```

---

## 数据导出与分析

### 4.1 导出配置

#### 自动导出设置
```
配置选项：
1. 导出路径：选择本地文件夹
2. 文件命名：
   - 静态：TikTok_Shop_榜单
   - 动态：TikTok_Shop_榜单_{{日期}}
3. 导出频率：
   - 实时导出
   - 采集完成后导出
4. 文件格式：Excel (.xlsx)
```

### 4.2 数据清洗建议

#### Python数据清洗示例
```python
import pandas as pd
import numpy as np

# 读取数据
df = pd.read_excel('TikTok_Shop_榜单.xlsx')

# 1. 去重
df = df.drop_duplicates(subset=['商品ID'])

# 2. 处理缺失值
df = df.dropna(subset=['商品名称', '价格'])

# 3. 数据格式转换
df['价格'] = df['价格'].str.replace('$', '').astype(float)
df['销量'] = df['销量'].astype(int)
df['采集时间'] = pd.to_datetime(df['采集时间'])

# 4. 异常值处理
df = df[df['销量'] > 0]  # 过滤销量为0的数据
df = df[df['价格'] < 1000]  # 过滤异常高价

# 5. 保存清洗后的数据
df.to_excel('TikTok_Shop_榜单_清洗后.xlsx', index=False)
```

### 4.3 数据分析示例

#### Excel数据分析
```
分析维度：
1. Top100商品分析
   - 平均价格：=AVERAGE(价格列)
   - 总销量：=SUM(销量列)
   - 价格分布：使用数据透视表

2. 类目分析
   - 各类目占比：饼图
   - 各类目销量对比：柱状图
   - 价格区间分析：直方图

3. 时间趋势
   - 按日期对比销量变化
   - 计算增长率
```

#### Python可视化
```python
import matplotlib.pyplot as plt
import seaborn as sns

# 设置中文显示
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 1. Top10商品销量对比
top10 = df.nlargest(10, '销量')
plt.figure(figsize=(12, 6))
plt.barh(top10['商品名称'], top10['销量'])
plt.title('Top10商品销量对比')
plt.xlabel('销量')
plt.ylabel('商品名称')
plt.tight_layout()
plt.savefig('top10_sales.png')

# 2. 价格分布
plt.figure(figsize=(10, 6))
plt.hist(df['价格'], bins=50, edgecolor='black')
plt.title('商品价格分布')
plt.xlabel('价格 ($)')
plt.ylabel('商品数量')
plt.savefig('price_distribution.png')

# 3. 类目销量占比
category_sales = df.groupby('类目')['销量'].sum()
plt.figure(figsize=(10, 10))
category_sales.plot.pie(autopct='%1.1f%%')
plt.title('各类目销量占比')
plt.savefig('category_sales.png')
```

---

## 定时任务设置

### 5.1 自动化采集

#### 设置定时任务
```
八爪鱼配置：
1. 点击"定时任务"
2. 设置采集频率：
   - 每天采集：09:00、18:00
   - 每周采集：周一早上
   - 每月采集：每月1号
3. 选择任务：TikTok_Shop_榜单采集
4. 启动定时任务
```

### 5.2 数据监控

#### 异常报警
```
监控指标：
1. 采集数据量异常（<预期值50%）
2. 采集失败次数>3次
3. 页面响应超时>30秒
4. 登录状态失效

报警方式：
- 邮件通知
- 微信推送
- 钉钉机器人
```

---

## 注意事项

### ⚠️ 法律合规
```
重要提醒：
1. 遵守TikTok Shop服务条款
2. 不采集用户隐私数据
3. 采集数据仅供自己使用
4. 不得转售采集数据
5. 控制采集频率，避免影响平台
```

### 📌 最佳实践
```
建议：
1. 采集时间：避开高峰期（9:00-11:00, 14:00-16:00）
2. 数据备份：每日备份采集数据
3. 版本管理：保留历史任务配置
4. 测试运行：先小规模测试，确认无误后正式运行
5. 日志记录：记录每次采集情况
```

---

## 完整配置示例

### 八爪鱼任务配置JSON
```json
{
  "task_name": "TikTok_Shop_榜单采集",
  "start_url": "https://seller.tiktokglobalshop.com/",
  "login": {
    "save_cookie": true,
    "cookie_days": 7
  },
  "data_fields": [
    "排名",
    "商品名称",
    "商品ID",
    "价格",
    "销量",
    "销售额",
    "店铺名称",
    "类目"
  ],
  "pagination": {
    "type": "click_next",
    "max_pages": 10,
    "wait_time": 3
  },
  "export": {
    "format": "xlsx",
    "path": "./data/",
    "filename": "TikTok_Shop_榜单_{{date}}"
  },
  "schedule": {
    "frequency": "daily",
    "time": "09:00"
  }
}
```

---

## 附录：快捷键与技巧

### 八爪鱼常用快捷键
```
- Ctrl+N：新建任务
- Ctrl+S：保存任务
- F5：运行任务
- F9：暂停任务
- Ctrl+Z：撤销操作
- Ctrl+Y：重做操作
```

### 提高效率的技巧
```
1. 使用模板保存常用配置
2. 批量操作多个相似任务
3. 使用云采集节省本地资源
4. 定期更新八爪鱼版本
5. 加入官方社群获取支持
```

---

## 总结

本教程涵盖了TikTok Shop榜单数据采集的完整流程：

✅ **前期准备**：工具安装、账号登录、需求确认
✅ **任务创建**：新建任务、登录录制、导航配置
✅ **数据提取**：字段识别、列表循环、自动翻页
✅ **导出分析**：格式选择、数据清洗、可视化展示
✅ **自动化**：定时任务、异常监控、最佳实践

按照本教程操作，你可以轻松实现TikTok Shop榜单数据的自动化采集和分析！

---

## 获取帮助

- 📖 八爪鱼官方文档：https://www.bazhuayu.com/help/
- 💬 官方论坛：https://www.bazhuayu.com/forum/
- 🎥 视频教程：B站搜索"八爪鱼RPA教程"
- 📧 技术支持：support@bazhuayu.com

---

**最后更新时间**：2025-02-21
**版本**：v1.0
**作者**：AI助手

祝你采集顺利！🎉
